{# backend/templates/well.html #}
{% extends "base.html" %}

{# ---------- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∫–ª–∞–¥–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ ---------- #}
{% block title %}
  –°–∫–≤–∞–∂–∏–Ω–∞: –°–∫–≤ {{ well.number or well.id }}
{% endblock %}

{# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã #}
{% block extra_head %}
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    /* === –ñ—ë—Å—Ç–∫–æ–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–∫–≤–∞–∂–∏–Ω—ã === */

    /* 0. –£–±–∏—Ä–∞–µ–º –ª—é–±—ã–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å—Ç—Ä–æ–∫ –∏ –ª–µ–≤—ã–µ –ø–æ–ª–æ—Å–∫–∏ */
    .events-table tr,
    .events-table__row {
      background: transparent !important;
      border-left: none !important;
    }

    /* 1. –ë–∞–∑–æ–≤—ã–π –≤–∏–¥ –≤—Å–µ—Ö —è—á–µ–µ–∫ */
    .events-table td {
      color: #333 !important;
      font-weight: 400;
    }

    /* 2. –ö–æ–ª–æ–Ω–∫–∞ "–¢–∏–ø" ‚Äî –Ω–∞—à–∞ —Ü–µ–ª–µ–≤–∞—è */
    .events-table__type {
      font-weight: 600;
    }

    /* 3. –ö—Ä–∞—Å–∏–º –¢–û–õ–¨–ö–û –∫–æ–ª–æ–Ω–∫—É "–¢–∏–ø" –ø–æ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è */

    /* —Ä–µ–∞–≥–µ–Ω—Ç */
    .events-table__row--reagent .events-table__type {
      color: #e53935 !important;
      font-weight: 700;
    }

    /* –¥–∞–≤–ª–µ–Ω–∏–µ */
    .events-table__row--pressure .events-table__type {
      color: #3949ab !important;
      font-weight: 700;
    }

    /* –ø—Ä–æ–¥—É–≤–∫–∞ */
    .events-table__row--purge .events-table__type {
      color: #ffa000 !important;
      font-weight: 700;
    }

    /* –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ */
    .events-table__row--equip .events-table__type {
      color: #43a047 !important;
      font-weight: 700;
    }

    /* –ø—Ä–æ—á–µ–µ / –∑–∞–º–µ—Ç–∫–∞ */
    .events-table__row--other .events-table__type,
    .events-table__row--note  .events-table__type {
      color: #9e9e9e !important;
      font-weight: 600;
    }
  </style>
{% endblock %}

{# ---------- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ---------- #}
{% block content %}

<div class="page-header">
  <a href="/visual"
     style="
       display:inline-flex;
       align-items:center;
       gap:10px;
       padding:8px 14px;
       border-radius:999px;
       background:#f3f4f6;
       border:1px solid #e5e7eb;
       text-decoration:none;
       color:#111827;
       font-size:14px;
       line-height:1.2;
     ">
    <span aria-hidden="true" style="
      width:24px;
      height:24px;
      border-radius:999px;
      background:#e5e7eb;
      display:flex;
      align-items:center;
      justify-content:center;
    ">
      <svg viewBox="0 0 20 20" width="14" height="14" style="display:block;">
        <path d="M12.5 4.5L8 9l4.5 4.5"
              fill="none"
              stroke="#111827"
              stroke-width="1.7"
              stroke-linecap="round"
              stroke-linejoin="round"/>
      </svg>
    </span>
    <span>–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —Å–∫–≤–∞–∂–∏–Ω</span>
  </a>
</div>

<div class="well-header-row">
  <div>
    <h1>–°–∫–≤–∞–∂–∏–Ω–∞: –°–∫–≤ {{ well.number or well.id }}</h1>
    <p class="well-id">ID –≤ –±–∞–∑–µ: {{ well.id }}</p>
  </div>

  {# –∏—â–µ–º css-–∫–ª–∞—Å—Å –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ —Å–µ—Ç–∫–µ well_status.grid #}
  {% set ns = namespace(current_css='') %}
  {% if well_status and well_status.current_status and well_status.grid %}
    {% for col in well_status.grid %}
      {% if col.label == well_status.current_status %}
        {% set ns.current_css = col.css %}
      {% endif %}
    {% endfor %}
  {% endif %}
  {% set current_css = ns.current_css %}
</div>

{# ===== –í–ï–†–•–ù–Ø–Ø –°–ï–¢–ö–ê: –°–¢–ê–¢–£–° + –ö–ê–ù–ê–õ + –û–ë–û–†–£–î–û–í–ê–ù–ò–ï + –ö–û–ù–°–¢–†–£–ö–¶–ò–Ø + –ö–ê–†–¢–ê ===== #}
{% if well_construction or (well.lat is not none and well.lon is not none) %}
<div
  style="
    display:grid;
    grid-template-columns:25% 15% 60%;
    gap:12px 16px;
    margin:16px 0 24px;
    align-items:stretch;
    box-sizing:border-box;
  "
>

  {# === –†–Ø–î 1, –ö–û–õ–û–ù–ö–ê 1: –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° === #}
  <div style="height:100%;">
    {% if well_status and well_status.current_status %}
      <div
        class="status-card {{ current_css }}"
        style="
          height:100%;
          border-radius:12px;
          padding:10px 14px;
          box-sizing:border-box;
          display:flex;
          flex-direction:column;
        "
      >
        <div style="
          font-size:11px;
          text-transform:uppercase;
          font-weight:700;
          letter-spacing:0.05em;
          opacity:0.9;
        ">
          –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
        </div>

        <div style="font-size:20px; font-weight:800; margin-top:4px;">
          {{ well_status.current_status }}
        </div>

        {% if well_status.current_note %}
          <div style="font-size:11px; margin-top:4px; opacity:0.9;">
            {{ well_status.current_note }}
          </div>
        {% endif %}

        {% if well_status.current_start %}
          <div style="font-size:10px; margin-top:auto; opacity:0.8;">
            –° {{ well_status.current_start.strftime("%d.%m.%Y %H:%M") }}
            {% if well_status.current_end %}
              –ø–æ {{ well_status.current_end.strftime("%d.%m.%Y %H:%M") }}
            {% else %}
              –ø–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è
            {% endif %}
          </div>
        {% endif %}
      </div>
    {% else %}
      <div
        style="
          height:100%;
          background:#f3f4f6;
          border-radius:12px;
          padding:10px 14px;
          border:1px dashed #d1d5db;
          box-sizing:border-box;
          display:flex;
          flex-direction:column;
          justify-content:center;
          color:#6b7280;
        "
      >
        <div style="font-size:11px; text-transform:uppercase; letter-spacing:0.05em;">
          –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
        </div>
        <div style="font-size:16px; margin-top:4px; font-weight:700;">
          –ù–µ –∑–∞–¥–∞–Ω
        </div>
      </div>
    {% endif %}
  </div>

  {# === –†–Ø–î 1, –ö–û–õ–û–ù–ö–ê 2: –ö–ê–ù–ê–õ –°–í–Ø–ó–ò === #}
  <div style="height:100%;">
    {% if channel_current %}
      <div
        style="
          height:100%;
          background:#e0f2fe;
          border-radius:12px;
          padding:10px 14px;
          border:1px solid #bfdbfe;
          box-sizing:border-box;
          display:flex;
          flex-direction:column;
        "
      >
        <div style="
            font-size:11px;
            text-transform:uppercase;
            color:#2563eb;
            font-weight:700;
            letter-spacing:0.05em;
        ">
          –ö–∞–Ω–∞–ª —Å–≤—è–∑–∏
        </div>

        {# —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç –Ω–æ–º–µ—Ä–∞ –∫–∞–Ω–∞–ª–∞ #}
        <div style="font-size:26px; font-weight:800; margin-top:4px; color:#1d4ed8;">
          {{ channel_current.channel }}
        </div>

        {% if channel_current.note %}
          <div style="font-size:11px; margin-top:4px; color:#374151;">
            {{ channel_current.note }}
          </div>
        {% endif %}

        {% if channel_current.started_at %}
          <div style="font-size:10px; margin-top:auto; color:#6b7280;">
            —Å {{ channel_current.started_at.strftime("%d.%m.%Y %H:%M") }}
          </div>
        {% endif %}
      </div>
    {% else %}
      <div
        style="
          height:100%;
          background:#f3f4f6;
          border-radius:12px;
          padding:10px 14px;
          border:1px dashed #d1d5db;
          box-sizing:border-box;
          display:flex;
          flex-direction:column;
          justify-content:center;
          color:#6b7280;
        "
      >
        <div style="font-size:11px; text-transform:uppercase; letter-spacing:0.05em;">
          –ö–∞–Ω–∞–ª —Å–≤—è–∑–∏
        </div>
        <div style="font-size:14px; margin-top:4px; font-weight:600;">
          –ù–µ –∑–∞–¥–∞–Ω
        </div>
      </div>
    {% endif %}
  </div>

  {# === –†–Ø–î 1, –ö–û–õ–û–ù–ö–ê 3: –û–ë–û–†–£–î–û–í–ê–ù–ò–ï (—Å–æ–≤–ø–∞–¥–∞–µ—Ç –ø–æ –∫–æ–ª–æ–Ω–∫–µ —Å –∫–∞—Ä—Ç–æ–π) === #}
    <div style="height:100%;">
    <div style="margin-bottom:4px;">
      <h2 style="margin:0; font-size:14px; font-weight:700;">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h2>
    </div>

    {% if current_equipment %}
      <div
        style="
          height:100%;
          display:flex;
          flex-wrap:wrap;
          gap:8px;
          align-content:flex-start;
          overflow-y:auto;
          padding-right:4px;
          box-sizing:border-box;
        "
      >
        {% for eq in current_equipment %}
          {% set eq_type = equipment_by_code.get(eq.type_code) %}
          <div
            style="
              background:#fffbeb;         /* –µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å —Ç–æ–ª—å–∫–æ —Ä–∞–º–∫—É ‚Äî –ø–æ–º–µ–Ω—è–π –Ω–∞ background:transparent; */
              border-radius:12px;
              padding:12px 12px;
              border:1px solid #fcd34d;
              min-width:230px;
              max-width:260px;
              box-sizing:border-box;
              display:flex;
              align-items:flex-start;
              gap:8px;
              font-size:12px;
            "
          >
            <div style="flex:1 1 auto;">
              <div style="
                  font-size:11px;
                  text-transform:uppercase;
                  color:#b45309;
                  font-weight:700;
                  letter-spacing:0.05em;
              ">
                {{ eq_type.label if eq_type else eq.type_code }}
              </div>

              <div style="font-size:14px; font-weight:700; margin-top:2px; color:#92400e;">
                SN: {{ eq.serial_number or "‚Äî" }}
              </div>

              {% if eq.channel %}
                <div style="font-size:11px; margin-top:2px; color:#78350f;">
                  –ö–∞–Ω–∞–ª: {{ eq.channel }}
                </div>
              {% endif %}

              {% if eq.installed_at %}
                <div style="font-size:10px; margin-top:2px; color:#6b7280;">
                  –£—Å—Ç–∞–Ω.: {{ eq.installed_at.strftime("%d.%m.%Y %H:%M") }}
                </div>
              {% endif %}

              {% if eq.note %}
                <div style="font-size:11px; margin-top:2px; color:#4b5563;">
                  {{ eq.note }}
                </div>
              {% endif %}
            </div>

<!--            {% if eq_type and eq_type.icon %}-->
<!--              <div style="flex:0 0 auto;">-->
<!--                <img-->
<!--                  src="{{ url_for('static', path='icons/' ~ eq_type.icon) }}"-->
<!--                  alt="{{ eq_type.label }}"-->
<!--                  style="width:60px; height:60px; object-fit:contain;"-->
<!--                >-->
<!--              </div>-->
                        {% if eq_type and eq_type.icon %}
              <div style="flex:0 0 auto;">
                <img
                  src="{{ url_for('static', path='icons/' ~ eq_type.icon) }}"
                  alt="{{ eq_type.label }}"
                  class="well-eq-icon"
                >
              </div>
            {% endif %}
            {% endif %}
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p style="font-size:12px; color:#6b7280; margin:0;">
        –ê–∫—Ç–∏–≤–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.
      </p>
    {% endif %}
  </div>

  {# === –†–Ø–î 2, –ö–û–õ–û–ù–ö–ò 1‚Äì2: –ö–û–ù–°–¢–†–£–ö–¶–ò–Ø –°–ö–í–ê–ñ–ò–ù–´ === #}
  <div
    style="
      grid-column:1 / span 2;
      background:#f9fafb;
      border-radius:16px;
      padding:16px 18px;
      border:1px solid #e5e7eb;
      box-shadow:0 4px 10px rgba(15,23,42,0.06);
      min-height:260px;
      display:flex;
      flex-direction:column;
    "
  >
    <h2 style="margin-top:0; margin-bottom:12px; font-size:18px; font-weight:700;">
      –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∫–≤–∞–∂–∏–Ω—ã
    </h2>

    {% if well_construction %}
      {# ‚Äî —Ç–≤–æ–π –ø—Ä–µ–∂–Ω–∏–π –±–ª–æ–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —Ç–∞–±–ª–∏—Ü–µ–π –ø–µ—Ä—Ñ–æ—Ä–∞—Ü–∏–∏ ‚Äî #}
      <div style="display:grid; grid-template-columns:auto 1fr; gap:6px 16px; font-size:13px;">

        <div style="font-weight:600; color:#374151;">–î–∏–∞–º–µ—Ç—Ä —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–æ–ª–æ–Ω–Ω—ã, –º–º:</div>
        <div>
          {% set v = well_construction["prod_casing_diam_mm"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–ì–ª—É–±–∏–Ω–∞ —Å–ø—É—Å–∫–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–æ–ª–æ–Ω–Ω—ã, –º:</div>
        <div>
          {% set v = well_construction["prod_casing_depth_m"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–¢–µ–∫—É—â–∏–π –∑–∞–±–æ–π, –º:</div>
        <div>
          {% set v = well_construction["current_bottomhole_m"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–ì–æ—Ä–∏–∑–æ–Ω—Ç:</div>
        <div>
          {% set v = well_construction["horizon"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–î–∏–∞–º–µ—Ç—Ä –ù–ö–¢, –º–º:</div>
        <div>
          {% set v = well_construction["tubing_diam_mm"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–ì–ª—É–±–∏–Ω–∞ –±–∞—à–º–∞–∫–∞ –ù–ö–¢, –º:</div>
        <div>
          {% set v = well_construction["tubing_shoe_depth_m"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–ì–ª—É–±–∏–Ω–∞ –ø–∞–∫–µ—Ä–∞, –º:</div>
        <div>
          {% set v = well_construction["packer_depth_m"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–ì–ª—É–±–∏–Ω–∞ –ø–µ—Ä–µ–≤–æ–¥–Ω–∏–∫–∞, –º:</div>
        <div>
          {% set v = well_construction["adapter_depth_m"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–ì–ª—É–±–∏–Ω–∞ –Ω–µ–ø—Ä–æ—Ö–æ–¥–∞ —à–∞–±–ª–æ–Ω–∞, –º:</div>
        <div>
          {% set v = well_construction["pattern_stuck_depth_m"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–î–∏–∞–º–µ—Ç—Ä —à—Ç—É—Ü–µ—Ä–∞, –º–º:</div>
        <div>
          {% set v = well_construction["choke_diam_mm"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>

        <div style="font-weight:600; color:#374151;">–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏:</div>
        <div>
          {% set v = well_construction["data_as_of"] %}
          {% if v is not none and v == v %}{{ v }}{% else %}-{% endif %}
        </div>
      </div>

      {% if perforation_intervals and perforation_intervals|length > 0 %}
        <h3 style="margin-top:16px; margin-bottom:6px; font-size:14px; font-weight:600;">
          –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–µ—Ä—Ñ–æ—Ä–∞—Ü–∏–∏
        </h3>
        <table class="table-history" style="font-size:12px;">
          <thead>
            <tr>
              <th>‚Ññ</th>
              <th>–°–≤–µ—Ä—Ö—É, –º</th>
              <th>–°–Ω–∏–∑—É, –º</th>
            </tr>
          </thead>
          <tbody>
            {% for p in perforation_intervals %}
              <tr>
                <td>{{ p.interval_index }}</td>
                <td>{{ p.top_depth_m }}</td>
                <td>{{ p.bottom_depth_m }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p style="margin-top:10px; color:#6b7280; font-size:13px;">
          –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–µ—Ä—Ñ–æ—Ä–∞—Ü–∏–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã.
        </p>
      {% endif %}
    {% else %}
      <div style="margin-top:8px; font-size:13px; color:#6b7280;">
        –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–∫–≤–∞–∂–∏–Ω—ã –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞.
      </div>
    {% endif %}
  </div>

  {# === –†–Ø–î 2, –ö–û–õ–û–ù–ö–ê 3: –ö–ê–†–¢–ê / –ü–†–ò–í–Ø–ó–ö–ê === #}
  <div
    style="
      background:#f9fafb;
      border-radius:16px;
      padding:12px 12px 16px;
      border:1px solid #e5e7eb;
      box-shadow:0 4px 10px rgba(15,23,42,0.06);
      min-height:260px;
      display:flex;
      flex-direction:column;
    "
  >
    {% if well.lat is not none and well.lon is not none %}
      <div style="
        display:flex;
        justify-content:space-between;
        align-items:center;
        margin-bottom:8px;
      ">
        <h2 style="margin:0; font-size:18px; font-weight:700;">
          –ö–∞—Ä—Ç–∞ / –ø—Ä–∏–≤—è–∑–∫–∞
        </h2>
        <div style="font-size:12px; color:#6b7280;">
          Lat: {{ well.lat }} ¬∑ Lon: {{ well.lon }}
        </div>
      </div>

      <div id="well-map"
           style="flex:1 1 auto; min-height:260px; border-radius:12px; overflow:hidden;">
      </div>
    {% else %}
      <div style="
        flex:1 1 auto;
        display:flex;
        align-items:center;
        justify-content:center;
        font-size:14px;
        color:#6b7280;
      ">
        –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–∫–≤–∞–∂–∏–Ω—ã –Ω–µ –∑–∞–¥–∞–Ω—ã.
      </div>
    {% endif %}
  </div>

</div>
{% endif %}


      <article class="card">
      <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–æ–±—ã—Ç–∏—è–º</h2>

      <form method="get" class="events-filter">
        <div class="events-filter__row">
          <label for="preset">–ü–µ—Ä–∏–æ–¥:</label>
          <select id="preset" name="preset">
            <option value="week"  {% if preset == 'week' %}selected{% endif %}>–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è</option>
            <option value="day"   {% if preset == 'day' %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏</option>
            <option value="month" {% if preset == 'month' %}selected{% endif %}>–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</option>
            <option value="all"   {% if preset == 'all' %}selected{% endif %}>–° –Ω–∞—á–∞–ª–∞ –±–∞–∑—ã</option>
            <option value="custom" {% if preset == 'custom' %}selected{% endif %}>–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥</option>
          </select>

          <label for="start">—Å</label>
          <input type="date" id="start" name="start" value="{{ start_date_value or '' }}">

          <label for="end">–ø–æ</label>
          <input type="date" id="end" name="end" value="{{ end_date_value or '' }}">

          <button type="submit">–ü–æ–∫–∞–∑–∞—Ç—å</button>
        </div>
      </form>

            {% if stats %}
        <div class="events-stats-cards">
          <div class="events-stats-card events-stats-card--reagent">
            <div class="events-stats-card__title">–í–±—Ä–æ—Å–æ–≤ —Ä–µ–∞–≥–µ–Ω—Ç–∞</div>
            <div class="events-stats-card__value">
              {{ stats.summary.total_reagent_injections }}
            </div>
            <div class="events-stats-card__sub">
              –í—Å–µ–≥–æ —Ä–µ–∞–≥–µ–Ω—Ç–∞:
              {{ "%.2f"|format(stats.summary.total_reagent_qty) }}
            </div>
          </div>

          <div class="events-stats-card events-stats-card--purge">
            <div class="events-stats-card__title">–ü—Ä–æ–¥—É–≤–æ–∫</div>
            <div class="events-stats-card__value">
              {{ stats.summary.total_purges }}
            </div>
          </div>

          <div class="events-stats-card events-stats-card--pressure">
            <div class="events-stats-card__title">–ó–∞–º–µ—Ä–æ–≤ –¥–∞–≤–ª–µ–Ω–∏—è</div>
            <div class="events-stats-card__value">
              {{ stats.summary.total_measurements }}
            </div>
          </div>

          <div class="events-stats-card events-stats-card--interval">
            <div class="events-stats-card__title">
              –°—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –≤–±—Ä–æ—Å–∞–º–∏
            </div>
            <div class="events-stats-card__value">
              {% if stats.summary.global_avg_interval_hours is not none %}
                {{ "%.1f"|format(stats.summary.global_avg_interval_hours) }} —á
              {% else %}
                ‚Äî
              {% endif %}
            </div>
          </div>
        </div>

        <p class="events-stats-period">
          –ü–µ—Ä–∏–æ–¥:
          {% if stats.start %}{{ stats.start.strftime("%d.%m.%Y") }}{% else %}‚Äî{% endif %}
          ‚Äî
          {% if stats.end %}{{ stats.end.strftime("%d.%m.%Y") }}{% else %}‚Äî{% endif %}
        </p>

{% if stats.per_reagent %}
  <h3>–ü–æ —Ä–µ–∞–≥–µ–Ω—Ç–∞–º</h3>
  <div class="well-table-block well-table-block--reagents">
    <table class="well-table well-table--reagents">
      <thead>
        <tr>
          <th>–†–µ–∞–≥–µ–Ω—Ç</th>
          <th class="is-number">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–±—Ä–æ—Å–æ–≤</th>
          <th class="is-number">–°—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
        </tr>
      </thead>
      <tbody>
        {% for r in stats.per_reagent %}
          <tr>
            <td>{{ r.reagent }}</td>
            <td class="is-number">{{ r.injections }}</td>
            <td class="is-number">{{ "%.2f"|format(r.total_qty) }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endif %}
      {% else %}
        <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.</p>
      {% endif %}
    </article>

    </article>

{# ========== –ì–†–ê–§–ò–ö –°–û–ë–´–¢–ò–ô ========== #}
{% if timeline_injections or timeline_events %}
<div class="card" style="margin-top: 20px;">
  <div class="card-header">
    <h2>üìä –ì—Ä–∞—Ñ–∏–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ —Å–∫–≤–∞–∂–∏–Ω–µ</h2>
    <small style="color: #6c757d;">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–∞–π–º–ª–∞–π–Ω –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π</small>
  </div>

  <div class="card-body">
    {# –õ–µ–≥–µ–Ω–¥—ã #}
    <div style="
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    ">
      {# –õ–µ–≥–µ–Ω–¥–∞ —Ä–µ–∞–≥–µ–Ω—Ç–æ–≤ #}
      <div style="
        background: white;
        padding: 15px;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        border: 1px solid #dee2e6;
      ">
        <div style="
          font-weight: 600;
          margin-bottom: 10px;
          font-size: 14px;
          color: #212529;
          display: flex;
          align-items: center;
          gap: 8px;
          padding-bottom: 10px;
          border-bottom: 2px solid #e9ecef;
        ">
          <span style="font-size: 18px;">üíâ</span>
          <span>–†–µ–∞–≥–µ–Ω—Ç—ã</span>
        </div>
        <div id="legend_reagents_well" style="padding: 8px 0;"></div>
      </div>

      {# –õ–µ–≥–µ–Ω–¥–∞ —Å–æ–±—ã—Ç–∏–π #}
      <div style="
        background: white;
        padding: 15px;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        border: 1px solid #dee2e6;
      ">
        <div style="
          font-weight: 600;
          margin-bottom: 10px;
          font-size: 14px;
          color: #212529;
          display: flex;
          align-items: center;
          gap: 8px;
          padding-bottom: 10px;
          border-bottom: 2px solid #e9ecef;
        ">
          <span style="font-size: 18px;">üìå</span>
          <span>–°–æ–±—ã—Ç–∏—è</span>
        </div>
        <div id="legend_events_well" style="padding: 8px 0;"></div>
      </div>

      {# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫–≤–∞–∂–∏–Ω–µ #}
      <div style="
        background: white;
        padding: 15px;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        border: 1px solid #dee2e6;
      ">
        <div style="
          font-weight: 600;
          margin-bottom: 10px;
          font-size: 14px;
          color: #212529;
          display: flex;
          align-items: center;
          gap: 8px;
          padding-bottom: 10px;
          border-bottom: 2px solid #e9ecef;
        ">
          <span style="font-size: 18px;">üéØ</span>
          <span>–°–∫–≤–∞–∂–∏–Ω–∞ {{ well.number or well.id }}</span>
        </div>
        <div style="padding: 8px 0; font-size: 13px; color: #6c757d;">
          <div><strong>–í–±—Ä–æ—Å–æ–≤ —Ä–µ–∞–≥–µ–Ω—Ç–æ–≤:</strong> {{ timeline_injections|length }}</div>
          <div><strong>–î—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π:</strong> {{ timeline_events|length }}</div>
          <div><strong>–í—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π:</strong> {{ (timeline_injections|length) + (timeline_events|length) }}</div>
        </div>
      </div>
    </div>

    {# –ì—Ä–∞—Ñ–∏–∫ #}
    <div class="chart-box" style="
      width: 100%;
      position: relative;
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      border: 1px solid #dee2e6;
    ">
      <div style="
        height: 450px;
        background: white;
        border-radius: 6px;
        padding: 15px;
        border: 1px solid #e9ecef;
      ">
        <canvas id="chart_timeline_well"></canvas>
      </div>

      <div style="
        margin-top: 15px;
        padding: 10px 15px;
        background: #e7f3ff;
        border-radius: 4px;
        font-size: 12px;
        color: #495057;
        border-left: 3px solid #0d6efd;
      ">
        <strong>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏:</strong>
        –í—ã–¥–µ–ª–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å –º—ã—à–∫–æ–π –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è ‚Ä¢
        Shift + –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è ‚Ä¢
        –ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ —Ç–æ—á–∫—É –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
      </div>
    </div>
  </div>
</div>
{% endif %}



<div class="well-layout">
  {# –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ #}
  <section class="well-grid">
    <article class="card" id="notes-card">
      <h2>–û–ø–∏—Å–∞–Ω–∏–µ / –Ω–∞–±–ª—é–¥–µ–Ω–∏—è</h2>

      <div style="
        display:grid;
        grid-template-columns:minmax(0, 2fr) minmax(0, 3fr);
        gap:16px;
        align-items:stretch;
      ">

        {# ===== –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ / —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏ ===== #}
        <div style="
          background:#f9fafb;
          border-radius:12px;
          padding:10px 10px;
          border:1px solid #e5e7eb;
          display:flex;
          flex-direction:column;
          height:100%;
        ">

          <div style="font-size:13px; color:#4b5563; margin-bottom:10px;">
            <strong>–¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∫–≤–∞–∂–∏–Ω—ã:</strong><br>
            {% if well.description %}
              <span>{{ well.description }}</span>
            {% else %}
              <span style="color:#9ca3af;">–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –∑–∞–¥–∞–Ω–æ.</span>
            {% endif %}
          </div>

            {# –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–º–µ—Ç–∫—É #}
            {% if note_edit is defined and note_edit %}
              {% set current_note = note_edit %}
            {% else %}
              {% set current_note = None %}
            {% endif %}

            <form method="post"
                  action="/well/{{ well.id }}/notes/save"
                  class="well-form">

              <input type="hidden" name="note_id"
                     value="{% if current_note %}{{ current_note.id }}{% endif %}">

              <div class="form-group" style="margin-bottom:10px;">
                <label for="noteTimeInput">–î–∞—Ç–∞ / –≤—Ä–µ–º—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è</label>
                <input
                  type="datetime-local"
                  id="noteTimeInput"
                  name="note_time"
                  style="width:50%; max-width:50%; box-sizing:border-box;"
                  value="{% if current_note and current_note.created_at %}{{ current_note.created_at.strftime('%Y-%m-%dT%H:%M') }}{% endif %}"
                />
              </div>

              <div class="form-group" style="margin-bottom:10px;">
                <label for="noteTextInput">–ó–∞–º–µ—Ç–∫–∞ / –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ</label>
                <textarea
                  id="noteTextInput"
                  name="note_text"
                  rows="4"
                  style="width:100%; max-width:100%; box-sizing:border-box; min-height:110px;"
                  placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø–∞–¥–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è, —É–≤–µ–ª–∏—á–∏–ª—Å—è –¥–µ–±–∏—Ç –≤–æ–¥—ã..."
                >{% if current_note %}{{ current_note.text }}{% endif %}</textarea>
              </div>

              <div class="form-actions">
                <button type="submit" class="btn-primary">
                  {% if current_note %}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è{% else %}–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å{% endif %}
                </button>

                {% if current_note %}
                  <a href="/well/{{ well.id }}#notes-card" class="btn-secondary btn-xs">
                    –û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                  </a>
                {% endif %}
              </div>
            </form>

        </div>

        {# ===== –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨: —Å–ø–∏—Å–æ–∫ –∑–∞–º–µ—Ç–æ–∫ –∏–∑ –±–∞–∑—ã ===== #}
        <div style="
          background:#f9fafb;
          border-radius:12px;
          padding:12px 14px;
          border:1px solid #e5e7eb;
          max-height:340px;
          overflow:auto;
          display:flex;
          flex-direction:column;
          height:100%;
        ">
<h3 style="margin-top:0; font-size:14px; font-weight:600;">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–º–µ—Ç–æ–∫</h3>

{% if notes is defined and notes %}
  <div id="notesList"
       style="display:flex; flex-direction:column; gap:3px;">
    {% for n in notes %}
      <div
        class="note-row"
        data-note-id="{{ n.id }}"
        onclick="selectNote({{ n.id }})"
        style="
          border-radius:6px;
          border:1px solid #e5e7eb;
          padding:3px 6px;
          background:#ffffff;
          font-size:12px;
          line-height:1.2;
          cursor:pointer;
          display:flex;
          align-items:baseline;
          gap:4px;
        "
      >
        <span style="font-weight:600; color:#111827; white-space:nowrap;">
          {{ n.created_at.strftime("%d.%m.%Y %H:%M") if n.created_at else "‚Äî" }}
        </span>
        <span>‚Äî</span>
        <span style="
          color:#4b5563;
          white-space:nowrap;
          overflow:hidden;
          text-overflow:ellipsis;
        ">
          {{ n.text }}
        </span>
      </div>
    {% endfor %}
  </div>

          {% if is_admin %}
     <div style="margin-top:6px; display:flex; justify-content:flex-end; gap:8px;">
    <button type="button"
            class="btn-secondary btn-xs"
            onclick="editSelectedNote()">
      –ò–∑–º–µ–Ω–∏—Ç—å
    </button>
    <button type="button"
            class="btn-secondary btn-xs danger"
            onclick="deleteSelectedNote()">
      –£–¥–∞–ª–∏—Ç—å
    </button>
  </div>

  <form id="noteDeleteForm" method="post" style="display:none;"></form>
  {% endif %}


{% else %}
  <p style="font-size:13px; color:#6b7280;">
    –î–ª—è —ç—Ç–æ–π —Å–∫–≤–∞–∂–∏–Ω—ã –µ—â—ë –Ω–µ—Ç –∑–∞–º–µ—Ç–æ–∫.
  </p>
{% endif %}
        </div>

      </div>
    </article>

<!--                 <article class="card">-->
<!--  <h2>SMOD –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>-->

<!--  {# -&#45;&#45; –ü–õ–ò–¢–ö–ê –ê–ö–¢–ò–í–ù–û–ì–û –ö–ê–ù–ê–õ–ê -&#45;&#45; #}-->
<!--  {% if channel_current %}-->
<!--    <div style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:20px;">-->
<!--      <div style="-->
<!--          background:#e0f2fe;-->
<!--          border-radius:12px;-->
<!--          padding:14px 18px;-->
<!--          border:1px solid #bfdbfe;-->
<!--          min-width:240px;-->
<!--      ">-->
<!--        <div style="-->
<!--            font-size:12px;-->
<!--            text-transform:uppercase;-->
<!--            color:#2563eb;-->
<!--            font-weight:700;-->
<!--            letter-spacing:0.05em;-->
<!--        ">-->
<!--          –ö–ê–ù–ê–õ –°–í–Ø–ó–ò-->
<!--        </div>-->

<!--        <div style="font-size:26px; font-weight:800; margin-top:4px; color:#1d4ed8;">-->
<!--          {{ channel_current.channel }}-->
<!--        </div>-->

<!--        {% if channel_current.note %}-->
<!--          <div style="font-size:13px; margin-top:6px; color:#374151;">-->
<!--            {{ channel_current.note }}-->
<!--          </div>-->
<!--        {% endif %}-->

<!--        {% if channel_current.started_at %}-->
<!--          <div style="font-size:11px; margin-top:6px; color:#6b7280;">-->
<!--            –ê–∫—Ç–∏–≤–µ–Ω —Å {{ channel_current.started_at.strftime("%d.%m.%Y %H:%M") }}-->
<!--          </div>-->
<!--        {% endif %}-->
<!--      </div>-->
<!--    </div>-->
<!--  {% else %}-->
<!--    <div style="-->
<!--        background:#f3f4f6;-->
<!--        border-radius:12px;-->
<!--        padding:10px 14px;-->
<!--        border:1px dashed #d1d5db;-->
<!--        margin-bottom:16px;-->
<!--        min-width:240px;-->
<!--    ">-->
<!--      <span style="font-size:13px; color:#6b7280;">-->
<!--        –ö–ê–ù–ê–õ –°–í–Ø–ó–ò –ù–ï –ó–ê–î–ê–ù-->
<!--      </span>-->
<!--    </div>-->
<!--  {% endif %}-->

<article class="card">
  <h2>–ò—Å—Ç–æ—Ä–∏—è –∫–∞–Ω–∞–ª–æ–≤</h2>

  {% if channel_history %}
    <div class="well-table-block well-table-block--channels">
      <table class="well-table well-table--channels">
        <thead>
          <tr>
            <th>–ö–∞–Ω–∞–ª</th>
            <th class="is-date">–ù–∞—á–∞–ª–æ</th>
            <th class="is-date">–û–∫–æ–Ω—á–∞–Ω–∏–µ</th>
            <th>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
          </tr>
        </thead>
        <tbody>
          {% for ch in channel_history %}
            <tr
              class="channel-row"
              data-channel-id="{{ ch.id }}"
              onclick="selectChannel({{ ch.id }})"
            >
              <td>{{ ch.channel }}</td>
              <td class="is-date">
                {{ ch.started_at.strftime("%d.%m.%Y %H:%M") if ch.started_at else "‚Äî" }}
              </td>
              <td class="is-date">
                {% if ch.ended_at %}
                  {{ ch.ended_at.strftime("%d.%m.%Y %H:%M") }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td>{{ ch.note or "" }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% if is_admin %}
    <div style="margin-top:8px; display:flex; justify-content:flex-end; gap:8px;">
      <button type="button"
              class="btn-primary btn-xs"
              onclick="openChannelModal(null)">
        –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª
      </button>
      <button type="button"
              class="btn-secondary btn-xs"
              onclick="editSelectedChannel()">
        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
      </button>
      <button type="button"
              class="btn-secondary btn-xs danger"
              onclick="deleteSelectedChannel()">
        –£–¥–∞–ª–∏—Ç—å
      </button>
    </div>

    <form id="channelDeleteForm" method="post" style="display:none;"></form>
   {% endif %}

  {% else %}
    <p>–î–ª—è —ç—Ç–æ–π —Å–∫–≤–∞–∂–∏–Ω—ã –ø–æ–∫–∞ –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∫–∞–Ω–∞–ª–æ–≤.</p>
  {% if is_admin %}
    <div style="margin-top:8px; display:flex; justify-content:flex-end;">
      <button type="button"
              class="btn-primary btn-xs"
              onclick="openChannelModal(null)">
        –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª
      </button>
    </div>
      {% endif %}
  {% endif %}
</article>


<!--{# ==== –û–ë–û–†–£–î–û–í–ê–ù–ò–ï –ù–ê –°–ö–í–ê–ñ–ò–ù–ï (–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–ª–∏—Ç–∫–∏ + –∏—Å—Ç–æ—Ä–∏—è) ==== #}-->
<!--<h2>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h2>-->

<!--{% if current_equipment %}-->
<!--  <div style="display:flex; flex-wrap:wrap; gap:12px; margin-bottom:20px;">-->
<!--    {% for eq in current_equipment %}-->
<!--      {% set eq_type = equipment_by_code.get(eq.type_code) %}-->
<!--      <div style="-->
<!--          background:#fffbeb;-->
<!--          border-radius:12px;-->
<!--          padding:12px 16px;-->
<!--          border:1px solid #fcd34d;-->
<!--          min-width:260px;-->
<!--      ">-->

<!--        <div style="-->
<!--          display:flex;-->
<!--          align-items:flex-start;-->
<!--          justify-content:space-between;-->
<!--          gap:12px;-->
<!--        ">-->

<!--          <div style="flex:1 1 auto;">-->
<!--            <div style="-->
<!--                font-size:12px;-->
<!--                text-transform:uppercase;-->
<!--                color:#b45309;-->
<!--                font-weight:700;-->
<!--                letter-spacing:0.05em;-->
<!--            ">-->
<!--              {{ eq_type.label if eq_type else eq.type_code }}-->
<!--            </div>-->

<!--            <div style="font-size:18px; font-weight:700; margin-top:4px; color:#92400e;">-->
<!--              SN: {{ eq.serial_number or "‚Äî" }}-->
<!--            </div>-->

<!--            {% if eq.channel %}-->
<!--              <div style="font-size:12px; margin-top:4px; color:#78350f;">-->
<!--                –ö–∞–Ω–∞–ª —Å–≤—è–∑–∏: {{ eq.channel }}-->
<!--              </div>-->
<!--            {% endif %}-->

<!--            {% if eq.installed_at %}-->
<!--              <div style="font-size:11px; margin-top:4px; color:#6b7280;">-->
<!--                –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: {{ eq.installed_at.strftime("%d.%m.%Y %H:%M") }}-->
<!--              </div>-->
<!--            {% endif %}-->

<!--            {% if eq.note %}-->
<!--              <div style="font-size:12px; margin-top:4px; color:#4b5563;">-->
<!--                {{ eq.note }}-->
<!--              </div>-->
<!--            {% endif %}-->
<!--          </div>-->

<!--          {% if eq_type and eq_type.icon %}-->
<!--            <div style="flex:0 0 auto; margin-left:8px;">-->
<!--              <img-->
<!--                src="{{ url_for('static', path='icons/' ~ eq_type.icon) }}"-->
<!--                alt="{{ eq_type.label }}"-->
<!--                style="width:60px; height:60px; object-fit:contain;"-->
<!--              >-->
<!--            </div>-->
<!--          {% endif %}-->

<!--        </div>-->
<!--      </div>-->
<!--    {% endfor %}-->
<!--  </div>-->
<!--{% else %}-->
<!--  <p>–ê–∫—Ç–∏–≤–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.</p>-->
<!--{% endif %}-->

<article class="card">
  <h2>–ò—Å—Ç–æ—Ä–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h2>

  {% if equipment_history %}
    <div class="well-table-block well-table-block--equipment">
      <table class="well-table well-table--equipment">
        <thead>
          <tr>
            <th>–¢–∏–ø</th>
            <th>SN</th>
            <th class="is-date">–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ</th>
            <th class="is-date">–î–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ</th>
            <th>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
          </tr>
        </thead>
        <tbody>
          {% for eq in equipment_history %}
            {% set eq_type = equipment_by_code.get(eq.type_code) %}
            <tr
              class="equipment-row"
              data-equipment-id="{{ eq.id }}"
              onclick="selectEquipment({{ eq.id }})"
            >
              <td>{{ eq_type.label if eq_type else eq.type_code }}</td>
              <td>{{ eq.serial_number or "‚Äî" }}</td>
              <td class="is-date">
                {% if eq.installed_at %}
                  {{ eq.installed_at.strftime("%d.%m.%Y %H:%M") }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td class="is-date">
                {% if eq.removed_at %}
                  {{ eq.removed_at.strftime("%d.%m.%Y %H:%M") }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td>{{ eq.note or "" }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    {% if is_admin %}
    <div style="margin-top:8px; display:flex; justify-content:flex-end; gap:8px;">
      <button type="button"
              class="btn-primary btn-xs"
              onclick="openEquipmentModal(null)">
        –î–æ–±–∞–≤–∏—Ç—å
      </button>
      <button type="button"
              class="btn-secondary btn-xs"
              onclick="editSelectedEquipment()">
        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
      </button>
      <button type="button"
              class="btn-secondary btn-xs danger"
              onclick="deleteSelectedEquipment()">
        –£–¥–∞–ª–∏—Ç—å
      </button>
    </div>

    <form id="equipmentDeleteForm" method="post" style="display:none;"></form>
  {% endif %}
  {% else %}
    <p>–ò—Å—Ç–æ—Ä–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.</p>
   {% if is_admin %}
    <div style="margin-top:8px; display:flex; justify-content:flex-end;">
      <button type="button"
              class="btn-primary btn-xs"
              onclick="openEquipmentModal(null)">
        –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
      </button>
    </div>
  {% endif %}
    {% endif %}
</article>


       {# === –ë–õ–û–ö: –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–ª–∏—Ç–∫–∞–º–∏ === #}
    <article class="card">
  <h2>–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤</h2>

  {% if well_status and well_status.grid %}
    <div class="status-grid">
      {# –û–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ = –æ–¥–∏–Ω —Ç–∏–ø —Å—Ç–∞—Ç—É—Å–∞ (–ù–∞–±–ª—é–¥–µ–Ω–∏–µ, –ê–¥–∞–ø—Ç–∞—Ü–∏—è, ...) #}
      {% for col in well_status.grid %}
        <div class="status-column">
          <div class="status-column-header {{ col.css }}">
            {{ col.label }}
          </div>

          {# —Å—Ç—Ä–æ–∫–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–ª–æ–Ω–∫–∏ = –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã —ç—Ç–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ #}
          {% for st in col["items"] %}
            <div
              class="status-card {{ col.css }} status-card--history"
              data-status-id="{{ st.id }}"
              onclick="selectStatus({{ st.id }})"
            >
              <div class="status-card-dates">
                {{ st.start.strftime("%d.%m.%Y %H:%M") }} ‚Äî
                {% if st.end %}
                  {{ st.end.strftime("%d.%m.%Y %H:%M") }}
                {% else %}
                  –ø–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è
                {% endif %}
              </div>
              <div class="status-card-days">
                {{ st.days }} —Å—É—Ç.
              </div>

              {% if st.note %}
                <div class="status-card-note">
                  {{ st.note }}
                </div>
              {% endif %}
            </div>
          {% endfor %}
        </div>
      {% endfor %}
    </div>

    {% if is_admin %}
      <div style="margin-top:8px; display:flex; justify-content:flex-end; gap:8px;">
        <button type="button"
                class="btn-primary btn-xs"
                onclick="openStatusModal(null)">
          –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
        </button>
        <button type="button"
                class="btn-secondary btn-xs"
                onclick="editSelectedStatus()">
          –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
        </button>
        <button type="button"
                class="btn-secondary btn-xs danger"
                onclick="deleteSelectedStatus()">
          –£–¥–∞–ª–∏—Ç—å
        </button>
      </div>

      <form id="statusDeleteForm" method="post" style="display:none;"></form>
    {% endif %}
  {% else %}
    <p>–î–ª—è —ç—Ç–æ–π —Å–∫–≤–∞–∂–∏–Ω—ã –µ—â—ë –Ω–µ –∑–∞–¥–∞–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤.</p>
    {% if is_admin %}
      <div style="margin-top:8px; display:flex; justify-content:flex-end;">
        <button type="button"
                class="btn-primary btn-xs"
                onclick="openStatusModal(null)">
          –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
        </button>
      </div>
    {% endif %}
  {% endif %}
</article>


    {# –ü–ª–∞–Ω—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É –Ω–∏–∂–µ #}
    <article class="card">
      <h2>–ü–ª–∞–Ω—ã</h2>
      <ul>
        <li>–ì—Ä–∞—Ñ–∏–∫–∏ –¥–∞–≤–ª–µ–Ω–∏—è/–¥–µ–±–∏—Ç–∞ —Å –¥–∞—Ç—á–∏–∫–æ–≤.</li>
        <li>–°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π –æ—Ç Telegram-–±–æ—Ç–∞.</li>
        <li>–ö–∞—Ä—Ç–∞ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º (–¥—Ä—É–≥–∏–µ —Å–∫–≤–∞–∂–∏–Ω—ã).</li>
      </ul>
    </article>

           <article class="card">
      <h2>–°–æ–±—ã—Ç–∏—è –ø–æ —Å–∫–≤–∞–∂–∏–Ω–µ</h2>

      {% if events and events|length > 0 %}
        <div class="events-table-wrapper">
          <table class="events-table">
  <thead>
    <tr>
      <th class="events-table__time">–î–∞—Ç–∞ / –≤—Ä–µ–º—è</th>
      <th class="events-table__type">–¢–∏–ø</th>
      <th class="events-table__reagent">–†–µ–∞–≥–µ–Ω—Ç</th>
      <th class="events-table__qty">–ö–æ–ª-–≤–æ</th>
      <th class="events-table__p">P—Ç—Ä, –∞—Ç–º</th>
      <th class="events-table__p">P—à–ª, –∞—Ç–º</th>
      <th class="events-table__details">–û–ø–∏—Å–∞–Ω–∏–µ / –¥–µ—Ç–∞–ª–∏</th>
      <th class="events-table__operator">–û–ø–µ—Ä–∞—Ç–æ—Ä</th>
      <th class="events-table__geo">–ì–µ–æ—Å—Ç–∞—Ç—É—Å</th>
    </tr>
  </thead>
  <tbody>
    {# namespace –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã #}
    {% set ns = namespace(current_date=None) %}

    {% for e in events %}
      {# –≤—ã—á–∏—Å–ª—è–µ–º –¥–∞—Ç—É —Å–æ–±—ã—Ç–∏—è (–±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏) #}
      {% if e.event_time %}
        {% set this_date = e.event_time.date() %}
      {% else %}
        {% set this_date = None %}
      {% endif %}

      {# –µ—Å–ª–∏ –¥–∞—Ç–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å ‚Äî –≤—Å—Ç–∞–≤–ª—è–µ–º —Å–µ—Ä—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å #}
      {% if this_date != ns.current_date %}
        <tr class="events-date-separator">
          <td colspan="9">
            {% if e.event_time %}
              {{ e.event_time.strftime("%d.%m.%Y") }}
            {% else %}
              –ë–µ–∑ –¥–∞—Ç—ã
            {% endif %}
          </td>
        </tr>
        {% set ns.current_date = this_date %}
      {% endif %}

      {# –æ–±—ã—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–±—ã—Ç–∏—è #}
      {% set row_type = (e.event_type or 'other')|lower %}
      <tr class="events-table__row events-table__row--{{ row_type }}">
        <td class="events-table__time">
          {% if e.event_time %}
            {{ e.event_time.strftime("%d.%m.%Y %H:%M") }}
          {% else %}‚Äî{% endif %}
        </td>

        <td class="events-table__type">
          {{ e.type_label }}
        </td>

        <td class="events-table__reagent">
          {{ e.reagent or "" }}
        </td>

        <td class="events-table__qty">
          {% if e.qty is not none %}
            {{ "%.2f"|format(e.qty) }}
          {% endif %}
        </td>

        <td class="events-table__p">
          {% if e.p_tube is not none %}
            {{ "%.2f"|format(e.p_tube) }}
          {% endif %}
        </td>

        <td class="events-table__p">
          {% if e.p_line is not none %}
            {{ "%.2f"|format(e.p_line) }}
          {% endif %}
        </td>

        <td class="events-table__details">
          {% if e.description %}
            {{ e.description }}
          {% endif %}

          {% if e.equip_type or e.equip_points or e.equip_other
                or e.purge_phase or e.geo_status %}
            {% if e.description %} ¬∑ {% endif %}
            {% if e.equip_type %}–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: {{ e.equip_type }}{% endif %}
            {% if e.equip_points %} ({{ e.equip_points }} —Ç–æ—á–µ–∫){% endif %}
            {% if e.equip_other %} {{ e.equip_other }}{% endif %}
            {% if e.purge_phase %} ¬∑ –ø—Ä–æ–¥—É–≤–∫–∞: {{ e.purge_phase }}{% endif %}
          {% endif %}
        </td>

        <td class="events-table__operator">
          {{ e.user_full_name or "" }}
        </td>

        <td class="events-table__geo">
          {{ e.geo_status_label or "" }}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
        </div>

        <div class="events-actions">
          <a href="/api/well/{{ well.id }}/events.csv" class="btn-secondary" target="_blank">
            –°–∫–∞—á–∞—Ç—å CSV
          </a>
          <a href="/api/well/{{ well.id }}/events.xlsx" class="btn-secondary" target="_blank">
            –°–∫–∞—á–∞—Ç—å Excel
          </a>
        </div>
      {% else %}
        <p>–î–ª—è —ç—Ç–æ–π —Å–∫–≤–∞–∂–∏–Ω—ã –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π –≤ —Ç–∞–±–ª–∏—Ü–µ <code>events</code>.</p>
      {% endif %}
    </article>




  {# –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: —Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è #}
    {% if is_admin %}
      <section class="well-edit">
      <article class="card">
        <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–∫–≤–∞–∂–∏–Ω—ã</h2>

        <form method="post" action="/well/{{ well.id }}/update" class="well-form">
          <div class="form-group">
            <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∫–≤–∞–∂–∏–Ω—ã</label>
            <input
              type="text"
              id="name"
              name="name"
              value="{{ well.name or '' }}"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–∫–≤ 1367"
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="lat">–®–∏—Ä–æ—Ç–∞ (lat)</label>
              <input
                type="text"
                id="lat"
                name="lat"
                value="{{ well.lat if well.lat is not none else '' }}"
                placeholder="45.12345"
              />
            </div>
            <div class="form-group">
              <label for="lon">–î–æ–ª–≥–æ—Ç–∞ (lon)</label>
              <input
                type="text"
                id="lon"
                name="lon"
                value="{{ well.lon if well.lon is not none else '' }}"
                placeholder="63.54321"
              />
            </div>
          </div>

          <div class="form-group">
            <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea
              id="description"
              name="description"
              rows="4"
              placeholder="–ö—Ä–∞—Ç–∫–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —Å–∫–≤–∞–∂–∏–Ω—ã, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏..."
            >{{ well.description or "" }}</textarea>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn-primary">
              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
            </button>
            <a href="/well/{{ well.id }}" class="btn-secondary">
              –û—Ç–º–µ–Ω–∏—Ç—å
            </a>
          </div>
        </form>

        <hr class="form-separator" />

        <h3>–°—Ç–∞—Ç—É—Å —Å–∫–≤–∞–∂–∏–Ω—ã</h3>

        {% set edit = well_status.edit_status %}
        {% if edit %}
          {% set current_status_text = edit.label %}
        {% else %}
          {% set current_status_text = None %}
        {% endif %}

          <form
            id="status-form"
            method="post"
            action="{% if edit %}/well/{{ well.id }}/status/{{ edit.id }}/edit{% else %}/well/{{ well.id }}/status{% endif %}"
            class="well-form"
          >
          <div class="form-group">
            <label for="status">–°—Ç–∞—Ç—É—Å</label>
            <select id="status" name="status">
              {% for s in allowed_statuses %}
                <option value="{{ s }}"
                  {% if current_status_text == s %}selected{% endif %}>
                  {{ s }}
                </option>
              {% endfor %}
              <option value="custom"
                {% if current_status_text and current_status_text not in allowed_statuses %}selected{% endif %}>
                –°–≤–æ–π —Å—Ç–∞—Ç—É—Å‚Ä¶
              </option>
            </select>
          </div>

          <div class="form-group" id="custom-status-group" style="display:none;">
            <label for="custom_status">–°–≤–æ–π —Å—Ç–∞—Ç—É—Å</label>
            <input
              type="text"
              id="custom_status"
              name="custom_status"
              value="{% if current_status_text and current_status_text not in allowed_statuses %}{{ current_status_text }}{% endif %}"
            />
          </div>

          <div class="form-group">
            <label for="status_start">–ù–∞—á–∞–ª–æ –¥–µ–π—Å—Ç–≤–∏—è</label>
            <input
              type="datetime-local"
              id="status_start"
              name="status_start"
              value="{% if edit and edit.start %}{{ edit.start.strftime('%Y-%m-%dT%H:%M') }}{% endif %}"
            />
          </div>

          <div class="form-group">
            <label for="status_end">–û–∫–æ–Ω—á–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
            <input
              type="datetime-local"
              id="status_end"
              name="status_end"
                value="{% if edit and edit.end %}{{ edit.end.strftime('%Y-%m-%dT%H:%M') }}{% endif %}"
            />
          </div>

          <div class="form-group">
            <label for="status_note">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
            <textarea id="status_note" name="status_note" rows="2">
    {% if edit and edit.note %}{{ edit.note }}{% endif %}
            </textarea>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn-primary">
              {% if edit %}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è{% else %}–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å{% endif %}
            </button>
            {% if edit %}
              <a href="/well/{{ well.id }}" class="btn-secondary btn-xs">
                –û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
              </a>
            {% endif %}
          </div>
        </form>
      </article>
      </section>
    {% endif %}
</div> {# –∫–æ–Ω–µ—Ü .well-layout #}

{% endblock %}  {# –∫–æ–Ω–µ—Ü block content #}

{# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã #}

{% block extra_scripts %}
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
//     (function() {
//       const lat = {{ well.lat if well.lat is not none else "null" }};
//       const lon = {{ well.lon if well.lon is not none else "null" }};
//
//       if (lat === null || lon === null) {
//         return;
//       }
//
//       const map = L.map('well-map', {
//   scrollWheelZoom: false    // <-- –≥–ª–∞–≤–Ω–æ–µ: –∫–æ–ª–µ—Å–æ –º—ã—à–∏ –ù–ï –∑—É–º–∏—Ç –∫–∞—Ä—Ç—É
// }).setView([lat, lon], 14);
//
//       L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
//         maxZoom: 19,
//         attribution: '&copy; OpenStreetMap contributors'
//       }).addTo(map);
//
//       const statusCss = "{{ current_css }}";
//       const color = getStatusColor(statusCss);
//       const icon = createStatusIcon(color);
//
//       const marker = L.marker([lat, lon], { icon }).addTo(map);
//
//       marker.bindPopup(
//         `–°–∫–≤–∞–∂–∏–Ω–∞: {{ (well.name or ("–°–∫–≤ " ~ well.id))|e }}<br>` +
//         `lat: ${lat}, lon: ${lon}`
//       );
//
//       marker.bindPopup(
//         `–°–∫–≤–∞–∂–∏–Ω–∞: {{ (well.name or ("–°–∫–≤ " ~ well.id))|e }}<br>` +
//         `lat: ${lat}, lon: ${lon}`
//       );
//     })();
  (function() {
      const lat = {{ well.lat if well.lat is not none else "null" }};
      const lon = {{ well.lon if well.lon is not none else "null" }};

      if (lat === null || lon === null) {
        return;
      }

      const map = L.map('well-map', {
        scrollWheelZoom: false
      }).setView([lat, lon], 14);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      // <<< –≤–æ—Ç —ç—Ç–æ –º–µ–Ω—è–µ–º >>>
      const marker = L.marker([lat, lon]).addTo(map);

      marker.bindPopup(
        `–°–∫–≤–∞–∂–∏–Ω–∞: {{ (well.name or ("–°–∫–≤ " ~ well.id))|e }}<br>` +
        `lat: ${lat}, lon: ${lon}`
      );
  })();
  </script>
  <script>
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∞ –ø–æ–ª—è "–°–≤–æ–π —Å—Ç–∞—Ç—É—Å"
    (function () {
      const select = document.getElementById('status');
      const customGroup = document.getElementById('custom-status-group');
      if (!select || !customGroup) return;

      function updateCustom() {
        if (select.value === 'custom') {
          customGroup.style.display = '';
        } else {
          customGroup.style.display = 'none';
        }
      }

      select.addEventListener('change', updateCustom);
      updateCustom(); // –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
    })();
  </script>

{% if is_admin %}
{# ==== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –°–¢–ê–¢–£–°–ê –°–ö–í–ê–ñ–ò–ù–´ ==== #}
<dialog id="statusModal">
  <form id="statusForm" method="post">
    <h3 id="statusFormTitle">–°—Ç–∞—Ç—É—Å —Å–∫–≤–∞–∂–∏–Ω—ã</h3>

    <label>
      –°—Ç–∞—Ç—É—Å
      <select name="status" id="statusModalSelect">
        {% for s in allowed_statuses %}
          <option value="{{ s }}">{{ s }}</option>
        {% endfor %}
        <option value="custom">–°–≤–æ–π —Å—Ç–∞—Ç—É—Å‚Ä¶</option>
      </select>
    </label>

    <div id="customStatusModalGroup" style="display:none; margin-top:6px;">
      <label>
        –°–≤–æ–π —Å—Ç–∞—Ç—É—Å
        <input type="text" name="custom_status" id="customStatusModalInput">
      </label>
    </div>

    <label>
      –ù–∞—á–∞–ª–æ –¥–µ–π—Å—Ç–≤–∏—è
      <input type="datetime-local" name="status_start" id="statusStartModalInput">
    </label>

    <label>
      –û–∫–æ–Ω—á–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
      <input type="datetime-local" name="status_end" id="statusEndModalInput">
    </label>

    <label>
      –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
      <textarea name="status_note" id="statusNoteModalInput" rows="2"></textarea>
    </label>

    <div class="form-actions">
      <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button type="button"
              class="btn-secondary"
              onclick="closeStatusModal()">
        –û—Ç–º–µ–Ω–∞
      </button>
    </div>
  </form>
</dialog>

<script>
  // –°–æ–±–∏—Ä–∞–µ–º —Å–ª–æ–≤–∞—Ä—å —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ id
  window.statusData = {
    {% if well_status and well_status.grid %}
      {% for col in well_status.grid %}
        {% for st in col["items"] %}
          {{ st.id }}: {
            label: {{ (st.label or col.label)|tojson }},
            start: "{{ st.start.strftime('%Y-%m-%dT%H:%M') if st.start else '' }}",
            end: "{{ st.end.strftime('%Y-%m-%dT%H:%M') if st.end else '' }}",
            note: {{ (st.note or '')|tojson }}
          },
        {% endfor %}
      {% endfor %}
    {% endif %}
  };

  const allowedStatusList = {{ allowed_statuses|tojson }};

  function openStatusModal(statusId) {
    const dlg = document.getElementById('statusModal');
    const form = document.getElementById('statusForm');
    const title = document.getElementById('statusFormTitle');

    const statusSelect = document.getElementById('statusModalSelect');
    const customGroup  = document.getElementById('customStatusModalGroup');
    const customInput  = document.getElementById('customStatusModalInput');
    const startInput   = document.getElementById('statusStartModalInput');
    const endInput     = document.getElementById('statusEndModalInput');
    const noteInput    = document.getElementById('statusNoteModalInput');

    function updateCustomVisibility() {
      if (statusSelect.value === 'custom') {
        customGroup.style.display = '';
      } else {
        customGroup.style.display = 'none';
      }
    }
    statusSelect.onchange = updateCustomVisibility;

    if (statusId && window.statusData[statusId]) {
      // –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å';
      form.action = '/well/{{ well.id }}/status/' + statusId + '/edit';

      const data = window.statusData[statusId];
      const label = data.label || '';

      if (allowedStatusList.indexOf(label) !== -1) {
        statusSelect.value = label;
        customInput.value = '';
      } else {
        statusSelect.value = 'custom';
        customInput.value = label;
      }

      startInput.value = data.start || '';
      endInput.value   = data.end || '';
      noteInput.value  = data.note || '';
    } else {
      // –†–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
      title.textContent = '–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å';
      form.action = '/well/{{ well.id }}/status';

      statusSelect.value = allowedStatusList.length > 0
        ? allowedStatusList[0]
        : 'custom';
      customInput.value  = '';
      startInput.value   = '';
      endInput.value     = '';
      noteInput.value    = '';
    }

    updateCustomVisibility();
    dlg.showModal();
  }

  function closeStatusModal() {
    document.getElementById('statusModal').close();
  }
</script>
{% endif %}
{# ==== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ö–ê–ù–ê–õ–ê –°–í–Ø–ó–ò ==== #}
{% if is_admin %}
<dialog id="channelModal">
  <form id="channelForm" method="post">
    <h3 id="channelFormTitle">–ö–∞–Ω–∞–ª —Å–≤—è–∑–∏</h3>

    <label>
      –ö–∞–Ω–∞–ª —Å–≤—è–∑–∏ (1‚Äì50)
      <input type="number" name="channel" id="channelInput" min="1" max="50" required>
    </label>

    <label>
      –î–∞—Ç–∞/–≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
      <input type="datetime-local" name="dt_start" id="channelStartInput">
    </label>

    <label>
      –î–∞—Ç–∞/–≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
      <input type="datetime-local" name="dt_end" id="channelEndInput">
    </label>

    <label>
      –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
      <textarea name="note" id="channelNoteInput" rows="2"></textarea>
    </label>

    <div class="form-actions">
      <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button type="button"
              class="btn-secondary"
              onclick="closeChannelModal()">
        –û—Ç–º–µ–Ω–∞
      </button>
    </div>
  </form>
</dialog>

<script>
  // –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–Ω–∞–ª–∞–º (–¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
  window.channelData = {
    {% for ch in channel_history %}
      {{ ch.id }}: {
        channel: {{ ch.channel }},
        dt_start: "{{ ch.started_at.strftime('%Y-%m-%dT%H:%M') if ch.started_at else '' }}",
        dt_end: "{{ ch.ended_at.strftime('%Y-%m-%dT%H:%M') if ch.ended_at else '' }}",
        note: {{ (ch.note or '')|tojson }}
      }{% if not loop.last %},{% endif %}
    {% endfor %}
  };

  function openChannelModal(channelId) {
    const dlg   = document.getElementById('channelModal');
    const form  = document.getElementById('channelForm');
    const title = document.getElementById('channelFormTitle');

    const inpChannel = document.getElementById('channelInput');
    const inpStart   = document.getElementById('channelStartInput');
    const inpEnd     = document.getElementById('channelEndInput');
    const inpNote    = document.getElementById('channelNoteInput');

    if (channelId) {
      // –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª —Å–≤—è–∑–∏';
      form.action = '/well/{{ well.id }}/channel/' + channelId + '/edit';

      const data = window.channelData[channelId];
      inpChannel.value = data.channel || '';
      inpStart.value   = data.dt_start || '';
      inpEnd.value     = data.dt_end || '';
      inpNote.value    = data.note || '';
    } else {
      // –†–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
      title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª —Å–≤—è–∑–∏';
      form.action = '/well/{{ well.id }}/channel/add';

      inpChannel.value = '';
      inpStart.value   = '';
      inpEnd.value     = '';
      inpNote.value    = '';
    }

    dlg.showModal();
  }

  function closeChannelModal() {
    document.getElementById('channelModal').close();
  }
</script>
{% endif %}

{# ==== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø ==== #}

<dialog id="equipmentModal">
  <form id="equipmentForm" method="post">
    <h3 id="equipmentFormTitle">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h3>

<label>
  –¢–∏–ø –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
  <select name="type_code" id="eqTypeInput" required>
    {% for eq_type in equipment_types %}
      <option value="{{ eq_type.code }}">{{ eq_type.label }}</option>
    {% endfor %}
  </select>
</label>

    <label>
      –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä
      <input type="text" name="serial_number" id="eqSerialInput">
    </label>


    <label>
  –î–∞—Ç–∞/–≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
  <input type="datetime-local" name="installed_at" id="eqInstalledInput">
</label>

<label>
  –î–∞—Ç–∞/–≤—Ä–µ–º—è –¥–µ–º–æ–Ω—Ç–∞–∂–∞
  <input type="datetime-local" name="removed_at" id="eqRemovedInput">
</label>

<label>
  –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
  <textarea name="note" id="eqNoteInput" rows="2"></textarea>
</label>

    <div class="form-actions">
      <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button type="button"
              class="btn-secondary"
              onclick="closeEquipmentModal()">
        –û—Ç–º–µ–Ω–∞
      </button>
    </div>
  </form>
</dialog>

<script>
  // –î–∞–Ω–Ω—ã–µ –ø–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é –¥–ª—è —Ä–µ–∂–∏–º–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
  window.equipmentData = {
    {% for eq in equipment_history %}
      {{ eq.id }}: {
        type_code: "{{ eq.type_code }}",
        serial_number: {{ (eq.serial_number or '')|tojson }},
        installed_at: "{{ eq.installed_at.strftime('%Y-%m-%dT%H:%M') if eq.installed_at else '' }}",
        removed_at: "{{ eq.removed_at.strftime('%Y-%m-%dT%H:%M') if eq.removed_at else '' }}",
        note: {{ (eq.note or '')|tojson }}
      }{% if not loop.last %},{% endif %}
    {% endfor %}
  };

  function openEquipmentModal(eqId) {
    const dlg   = document.getElementById('equipmentModal');
    const form  = document.getElementById('equipmentForm');
    const title = document.getElementById('equipmentFormTitle');

    const typeInput      = document.getElementById('eqTypeInput');
    const serialInput    = document.getElementById('eqSerialInput');
    const installedInput = document.getElementById('eqInstalledInput');
    const removedInput   = document.getElementById('eqRemovedInput');
    const noteInput      = document.getElementById('eqNoteInput');

    if (eqId) {
      // --- —Ä–µ–∂–∏–º –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø ---
      title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ';
      form.action = '/well/{{ well.id }}/equipment/' + eqId + '/edit';

      const data = window.equipmentData[eqId];

      typeInput.value      = data.type_code || '';
      serialInput.value    = data.serial_number || '';
      installedInput.value = data.installed_at || '';
      removedInput.value   = data.removed_at || '';
      noteInput.value      = data.note || '';
    } else {
      // --- —Ä–µ–∂–∏–º –î–û–ë–ê–í–õ–ï–ù–ò–Ø ---
      title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ';
      form.action = '/well/{{ well.id }}/equipment/add';

      typeInput.value      = '';
      serialInput.value    = '';
      installedInput.value = '';
      removedInput.value   = '';
      noteInput.value      = '';
    }

    dlg.showModal();
  }

  function closeEquipmentModal() {
    document.getElementById('equipmentModal').close();
  }
</script>

<script>
  // –ï—Å–ª–∏ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–º–µ—Ç–∫—É –∏ –ø–æ–ª–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—É—Å—Ç–æ–µ ‚Äî
  // –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
  (function () {
    const input = document.getElementById('noteTimeInput');
    if (!input) return;
    if (input.value) return;  // –∑–Ω–∞—á–∏—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å

    const now = new Date();
    const offset = now.getTimezoneOffset();
    now.setMinutes(now.getMinutes() - offset);
    input.value = now.toISOString().slice(0, 16); // YYYY-MM-DDTHH:MM
  })();
</script>

{% if is_admin %}
<script>
  // ================== –ó–ê–ú–ï–¢–ö–ò ==================
  let selectedNoteId = null;

  function selectNote(id) {
    selectedNoteId = id;

    const rows = document.querySelectorAll('.note-row');
    rows.forEach((row) => {
      if (parseInt(row.dataset.noteId, 10) === id) {
        row.style.background = '#e5f0ff';
        row.style.borderColor = '#3b82f6';
      } else {
        row.style.background = '#ffffff';
        row.style.borderColor = '#e5e7eb';
      }
    });
  }

  function editSelectedNote() {
    if (!selectedNoteId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –∑–∞–º–µ—Ç–∫—É.');
      return;
    }
    window.location.href =
      '/well/{{ well.id }}?edit_note=' + selectedNoteId + '#notes-card';
  }

  function deleteSelectedNote() {
    if (!selectedNoteId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –∑–∞–º–µ—Ç–∫—É.');
      return;
    }
    if (!confirm('–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –∑–∞–ø–∏—Å—å?')) {
      return;
    }
    const form = document.getElementById('noteDeleteForm');
    form.action = '/well/{{ well.id }}/notes/' + selectedNoteId + '/delete';
    form.submit();
  }

  // ================== –ö–ê–ù–ê–õ–´ –°–í–Ø–ó–ò ==================
  let selectedChannelId = null;

  function selectChannel(id) {
    selectedChannelId = id;

    const rows = document.querySelectorAll('.channel-row');
    rows.forEach((row) => {
      if (parseInt(row.dataset.channelId, 10) === id) {
        row.style.background = '#e5f0ff';
      } else {
        row.style.background = '';
      }
    });
  }

  function editSelectedChannel() {
    if (!selectedChannelId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –∫–∞–Ω–∞–ª.');
      return;
    }
    openChannelModal(selectedChannelId);
  }

  function deleteSelectedChannel() {
    if (!selectedChannelId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –∫–∞–Ω–∞–ª.');
      return;
    }
    if (!confirm('–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª?')) {
      return;
    }
    const form = document.getElementById('channelDeleteForm');
    form.action = '/well/{{ well.id }}/channel/' + selectedChannelId + '/delete';
    form.submit();
  }

  // ================== –û–ë–û–†–£–î–û–í–ê–ù–ò–ï ==================
  let selectedEquipmentId = null;

  function selectEquipment(id) {
    selectedEquipmentId = id;

    const rows = document.querySelectorAll('.equipment-row');
    rows.forEach((row) => {
      if (parseInt(row.dataset.equipmentId, 10) === id) {
        row.style.background = '#e5f0ff';
      } else {
        row.style.background = '';
      }
    });
  }

  function editSelectedEquipment() {
    if (!selectedEquipmentId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ.');
      return;
    }
    openEquipmentModal(selectedEquipmentId);
  }

  function deleteSelectedEquipment() {
    if (!selectedEquipmentId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ.');
      return;
    }
    if (!confirm('–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ?')) {
      return;
    }
    const form = document.getElementById('equipmentDeleteForm');
    form.action = '/well/{{ well.id }}/equipment/' + selectedEquipmentId + '/delete';
    form.submit();
  }

  // ================== –°–¢–ê–¢–£–°–´ –°–ö–í–ê–ñ–ò–ù–´ ==================
  let selectedStatusId = null;

  function selectStatus(id) {
    selectedStatusId = id;

    const cards = document.querySelectorAll('.status-card--history');
    cards.forEach((card) => {
      if (parseInt(card.dataset.statusId, 10) === id) {
        card.style.outline = '2px solid #3b82f6';
        card.style.backgroundColor = 'rgba(59,130,246,0.08)';
      } else {
        card.style.outline = '';
        card.style.backgroundColor = '';
      }
    });
  }

  function editSelectedStatus() {
    if (!selectedStatusId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ —Å—Ç–∞—Ç—É—Å.');
      return;
    }
    openStatusModal(selectedStatusId);
  }

  function deleteSelectedStatus() {
    if (!selectedStatusId) {
      alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ —Å—Ç–∞—Ç—É—Å.');
      return;
    }
    if (!confirm('–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å?')) {
      return;
    }
    const form = document.getElementById('statusDeleteForm');
    form.action = '/well/{{ well.id }}/status/' + selectedStatusId + '/delete';
    form.submit();
  }
</script>
{% endif %}

{# JS-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π #}
<script>
  window.wellEventsData = {
    timelineInjections: {{ timeline_injections | tojson | safe }},
    timelineEvents: {{ timeline_events | tojson | safe }},
    reagentColors: {{ reagent_colors | tojson | safe }},
    eventColors: {{ event_colors | tojson | safe }},
    wellNumber: "{{ well_number }}",
  };
</script>

<!-- Chart.js –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
<script src="https://cdn.jsdelivr.net/npm/luxon@3"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2"></script>

<!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å–∫–≤–∞–∂–∏–Ω—ã -->
<script src="/static/js/well_events_chart.js"></script>
{# ==============================================================================
   –î–û–ë–ê–í–ò–¢–¨ –í well.html –ü–ï–†–ï–î –ó–ê–ö–†–´–í–ê–Æ–©–ò–ú {% endblock %}
   (–ø–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω)
   ============================================================================== #}

{# ========== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ù–ê–°–¢–†–û–ô–ö–ò –¶–í–ï–¢–û–í ========== #}
<dialog id="colorModalWell" style="
  border: none;
  border-radius: 12px;
  padding: 0;
  max-width: 600px;
  width: 90%;
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
">
  <div style="
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 20px;
    border-radius: 12px 12px 0 0;
    color: white;
  ">
    <h3 style="margin: 0; font-size: 20px; font-weight: 700;">
      üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤ –≥—Ä–∞—Ñ–∏–∫–∞
    </h3>
  </div>

  <div style="padding: 20px; max-height: 500px; overflow-y: auto;">
    <div id="colorInputsWell"></div>
  </div>

  <div style="
    display: flex;
    gap: 10px;
    padding: 15px 20px;
    background: #f8f9fa;
    border-radius: 0 0 12px 12px;
    border-top: 1px solid #dee2e6;
  ">
    <button
      onclick="saveColorsWell()"
      style="
        flex: 1;
        padding: 10px 20px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      "
      onmouseover="this.style.background='#218838'"
      onmouseout="this.style.background='#28a745'"
    >
      ‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
    </button>
    <button
      onclick="closeColorSettingsWell()"
      style="
        flex: 1;
        padding: 10px 20px;
        background: #6c757d;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      "
      onmouseover="this.style.background='#5a6268'"
      onmouseout="this.style.background='#6c757d'"
    >
      ‚úó –û—Ç–º–µ–Ω–∞
    </button>
  </div>
</dialog>

<style>
/* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
#colorModalWell::backdrop {
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

#colorModalWell[open] {
  animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-50px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ */
#colorInputsWell::-webkit-scrollbar {
  width: 8px;
}

#colorInputsWell::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 4px;
}

#colorInputsWell::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 4px;
}

#colorInputsWell::-webkit-scrollbar-thumb:hover {
  background: #555;
}
</style>

{% endblock %}